default: &default
  first_thing:
    - snippet: cloud66/node
      target: any
      execute: true
    - command: npm install -g bower
      sudo: true
      target: any
      execute: true

development:
  <<: *default
  after_rails:
    - source: /.cloud66/scripts/reseed_custom_content.sh
      destination: /tmp/reseed_custom_content.sh
      target: rails
      execute: true
      run_on: single_server
      apply_during: all
      sudo: false
    - source: /.cloud66/scripts/rebuild_indexes.sh
      destination: /tmp/rebuild_indexes.sh
      target: rails
      execute: true
      run_on: single_server
      apply_during: all
      sudo: false

staging:
  <<: *default
  after_rails:
    - source: /.cloud66/scripts/reseed_custom_content.sh
      destination: /tmp/reseed_custom_content.sh
      target: rails
      execute: true
      run_on: single_server
      apply_during: all
      sudo: false
    - source: /.cloud66/scripts/rebuild_indexes.sh
      destination: /tmp/rebuild_indexes.sh
      target: rails
      execute: true
      run_on: single_server
      apply_during: all
      sudo: false

production:
  <<: *default
    - source: /.cloud66/scripts/rebuild_indexes.sh
      destination: /tmp/rebuild_indexes.sh
      target: rails
      execute: true
      run_on: single_server
      apply_during: all
      sudo: false
